<!DOCTYPE html>

<html lang="zh-cn">
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="format-detection" content="telephone=no"/>

    <title>Frame&#39;s Blog</title>
    
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#FF3DB4">
    <meta name="theme-color" content="#ffffff">

    
    
    
    <link rel="stylesheet" href="/css/main.min.2545a1910010e26a9905276045afab868f812580a1e7482423da6c0c8c214d18.css"/>

    
    
    

    
    
 
    
    
</head>
    <body>
        
<nav>
  <header>
    <div class="site-title">
        <a href="/">Frame&#39;s Blog</a>
    </div>  
</header>
  <div class="nav-menu">
  
    <a class="color-link nav-link" href="/about/">关于</a>
  
    <a class="color-link nav-link" href="/tags/">标签</a>
  
    <a class="color-link nav-link" href="/archives/">归档</a>
  
</div>
<footer class="footer">
	<div class="social-icons">
        
    <a class="social-icon" href="mailto:saintube@foxmail.com" target="_blank" rel="noopener" title="Email">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="https://www.w3.org/2000/svg" xmlns:xlink="https://www.w3.org/1999/xlink">
            <path d="M25.2794292,5.59128519 L14,16.8707144 L2.72057081,5.59128519 C3.06733103,5.30237414 3.51336915,5.12857603 4,5.12857603 L24,5.12857603 C24.4866308,5.12857603 24.932669,5.30237414 25.2794292,5.59128519 Z M25.9956978,6.99633695 C25.998551,7.04004843 26,7.08414302 26,7.12857603 L26,20.871424 C26,21.0798433 25.9681197,21.2808166 25.9089697,21.4697335 L18.7156355,14.2763993 L25.9956978,6.99633695 Z M24.9498374,22.6319215 C24.6672737,22.7846939 24.3437653,22.871424 24,22.871424 L4,22.871424 C3.5268522,22.871424 3.09207889,22.7071233 2.74962118,22.432463 L10.0950247,15.0870594 L13.9848068,18.9768415 L14.1878486,18.7737996 L14.2030419,18.7889929 L17.6549753,15.3370594 L24.9498374,22.6319215 Z M2.00810114,21.0526627 C2.00273908,20.9929669 2,20.9325153 2,20.871424 L2,7.12857603 C2,7.08414302 2.00144896,7.04004843 2.00430222,6.99633695 L9.03436454,14.0263993 L2.00810114,21.0526627 Z"></path>
        </svg>
    </a>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    
    
    <a class="social-icon" href="https://www.github.com/saintube" target="_blank" rel="noopener" title="GitHub">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="https://www.w3.org/2000/svg" xmlns:xlink="https://www.w3.org/1999/xlink">
            <path d="M13.9988029,1.32087331 C6.82105037,1.32087331 1,7.14112562 1,14.3212723 C1,20.0649109 4.72454649,24.9370678 9.89038951,26.6560892 C10.5408085,26.7757983 10.7778323,26.374374 10.7778323,26.0296121 C10.7778323,25.7215609 10.7666595,24.9035493 10.760275,23.8189856 C7.14426471,24.6042767 6.38131925,22.0760223 6.38131925,22.0760223 C5.78995672,20.5740732 4.93762853,20.1742451 4.93762853,20.1742451 C3.75729765,19.3682044 5.02701126,19.3841656 5.02701126,19.3841656 C6.33183953,19.4759425 7.01817121,20.7241085 7.01817121,20.7241085 C8.17775254,22.7104801 10.0611744,22.1366749 10.8017741,21.8038838 C10.919887,20.9643246 11.2558703,20.3913175 11.6269683,20.066507 C8.74038491,19.7385043 5.70536235,18.6228163 5.70536235,13.6413251 C5.70536235,12.2223743 6.21213051,11.0611968 7.04370914,10.1530044 C6.90963504,9.82420367 6.46351945,8.50181809 7.17139875,6.71256734 C7.17139875,6.71256734 8.26234691,6.36301702 10.7459099,8.04532771 C11.78259,7.75642995 12.8950858,7.61277914 14.000399,7.60719272 C15.1049142,7.61277914 16.2166119,7.75642995 17.2548881,8.04532771 C19.736855,6.36301702 20.8262071,6.71256734 20.8262071,6.71256734 C21.5356825,8.50181809 21.0895669,9.82420367 20.9562909,10.1530044 C21.7894656,11.0611968 22.2922435,12.2223743 22.2922435,13.6413251 C22.2922435,18.6355852 19.2524325,19.734514 16.3570705,20.0561322 C16.8231376,20.4575564 17.2389269,21.2508282 17.2389269,22.4638795 C17.2389269,24.2012564 17.2229657,25.603448 17.2229657,26.0296121 C17.2229657,26.3775663 17.4575954,26.7821827 18.116793,26.6552912 C23.2786458,24.9322794 27,20.0633148 27,14.3212723 C27,7.14112562 21.1789496,1.32087331 13.9988029,1.32087331"></path>
        </svg>
    </a>
    

    
    
    

    

    

    

    

</div>




	<p><a href="https://www.cncf.io/" target="_blank" rel="noopener">CNCF</a></p>
	<p><a href="https://landscape.cncf.io/" target="_blank" rel="noopener">Landscape</a></p>
	<p><a href="https://gohugo.io" target="_blank" rel="noopener">Built with Hugo</a></p>

	<script src="/js/main.min.fa5c2b23e07b5d9bfad267a52b4b24fdb053e6fb7524993383594926a3ac270c.js" integrity="sha256-+lwrI+B7XZv60melK0sk/bBT5vt1JJkzg1lJJqOsJww="></script>
</footer>
</nav>
        <div id="content" class="content-container">
        
<h1 class="post-title">Device Plugin 入门笔记（二）</h1>
    
    <time>March 13, 2020</time>
    
    <div>
        <p>
        <p>本节承接上一节对Kubernetes Device Plugin的介绍，以几个社区的Device Plugin方案为例，包括</p>
<ul>
<li><a href="#review">Review</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#nvidia-device">NVIDIA Device</a>
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#usage">Usage</a></li>
<li><a href="#insight">Insight</a></li>
<li><a href="#discussion">Discussion</a></li>
</ul>
</li>
<li><a href="#intel-sriov-network-device">Intel SRIOV Network Device</a></li>
<li><a href="#aliyuncontainerservice-gpushare">AliyunContainerService GPUShare</a></li>
<li><a href="#references">References</a></li>
</ul>
<p>以探索Device Plugin的设计、使用以及代码结构。</p>
<h2 id="review">Review</h2>
<p>回顾上一节对Device Plugin的介绍，<code>Device Manager</code>是K8s社区提供给设备服务商的一种统一的插件化方案，是自Kubernetes v1.11的beta feature。<br>
它通过<code>Extended Resources</code>和<code>Device Plugin</code>这两个模块，允许用户自定义某种设备资源在K8s上的管控逻辑；不过管控层面上仅限于资源的发现、health check以及分配，不负责异构节点的拓扑维护或监控数据收集。</p>
<p>在实现上，Device Plugin实际是一个运行在Kubelet所在的Node上的gRPC server，通过Unix Socket、基于以下（简化的）API来和Kubelet的gRPC server通信，并维护对应设备资源在当前Node上的注册、发现、分配、卸载。<br>
其中，<code>ListAndWatch()</code>负责对应设备资源的discovery和watch；<code>Allocate()</code>负责设备资源的分配。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#a6e22e">service</span> <span style="color:#a6e22e">DevicePlugin</span> {
    <span style="color:#75715e">// returns a stream of []Device
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">rpc</span> <span style="color:#a6e22e">ListAndWatch</span>(<span style="color:#a6e22e">Empty</span>) <span style="color:#a6e22e">returns</span> (<span style="color:#a6e22e">stream</span> <span style="color:#a6e22e">ListAndWatchResponse</span>) {}
    <span style="color:#a6e22e">rpc</span> <span style="color:#a6e22e">Allocate</span>(<span style="color:#a6e22e">AllocateRequest</span>) <span style="color:#a6e22e">returns</span> (<span style="color:#a6e22e">AllocateResponse</span>) {}
}
</code></pre></div><h2 id="installation">Installation</h2>
<p><strong>Environment</strong>:</p>
<p>社区推荐的方案是让Device Plugin运行在K8s编排的容器内，方便K8s在Device Plugin失效时重启它们；不过，也并不阻止大家把Device Plugin运行在裸机上。</p>
<p><strong>Deployment</strong>:</p>
<p>对于Device Plugin的容器化部署方案，我们可以理所当然地想到用DaemonSet。用DaemonSet部署可以不对K8s集群本身做出额外改动，只需要通过亲和性调度和DaemonSet本身的特性，就可以让Device Plugin部署在需要它的Nodes上，类似如下方式。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#66d9ef">apiVersion</span>: extensions/v1beta1
<span style="color:#66d9ef">kind</span>: DaemonSet
<span style="color:#66d9ef">metadata</span>:
<span style="color:#66d9ef">spec</span>:
    <span style="color:#66d9ef">template</span>:
        <span style="color:#66d9ef">metadata</span>:
            <span style="color:#66d9ef">labels</span>:
                - <span style="color:#66d9ef">name</span>: device-plugin
        <span style="color:#66d9ef">spec</span>:
            <span style="color:#66d9ef">nodeSelector</span>:
                <span style="color:#66d9ef">nvidia-gpu</span>: <span style="color:#66d9ef">true</span>
            <span style="color:#66d9ef">containers</span>:
                <span style="color:#66d9ef">name</span>: device-plugin-ctr
                <span style="color:#66d9ef">image</span>: NVIDIA/device-plugin:<span style="color:#ae81ff">1.0</span>
                <span style="color:#66d9ef">volumeMounts</span>:
                  - <span style="color:#66d9ef">mountPath</span>: /device-plugin
                  - <span style="color:#66d9ef">name</span>: device-plugin
           <span style="color:#66d9ef">volumes</span>:
             - <span style="color:#66d9ef">name</span>: device-plugin
               <span style="color:#66d9ef">hostPath</span>:
                   <span style="color:#66d9ef">path</span>: /var/lib/kubelet/device-plugins
</code></pre></div><p>除此之外，一些像kubeadm之类的K8s部署工具已经集成了经过社区验证的Device Plugins部署。</p>
<h2 id="nvidia-device">NVIDIA Device</h2>
<h3 id="overview">Overview</h3>
<p>NVIDIA提供的这个Device Plugin当然是服务于GPU的，它可能是社区中最经典的Device Plugin了，所以下面的分析就以它为例。</p>
<p>它以DaemonSet的形式在K8s集群上运行：</p>
<ul>
<li>暴露各Nodes的GPUs数目；</li>
<li>跟踪GPUs的健康情况；</li>
<li>帮助运行启用了GPU的容器。</li>
</ul>
<h3 id="usage">Usage</h3>
<ol>
<li>
<p>安装NVIDIA Device Plugin之前，需要准备好指定版本的NVIDIA驱动、<a href="https://github.com/NVIDIA/nvidia-docker">nvidia-docker</a>、nvidia-container-runtime以及K8s集群。</p>
</li>
<li>
<p>配置nvidia-container-runtime为对应Nodes上的Docker默认运行时。</p>
</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="color:#960050;background-color:#1e0010">#</span> <span style="color:#960050;background-color:#1e0010">/etc/docker/daemon.json</span>
{
    <span style="color:#f92672">&#34;default-runtime&#34;</span>: <span style="color:#e6db74">&#34;nvidia&#34;</span>,
    <span style="color:#f92672">&#34;runtimes&#34;</span>: {
        <span style="color:#f92672">&#34;nvidia&#34;</span>: {
            <span style="color:#f92672">&#34;path&#34;</span>: <span style="color:#e6db74">&#34;/usr/bin/nvidia-container-runtime&#34;</span>,
            <span style="color:#f92672">&#34;runtimeArgs&#34;</span>: []
        }
    }
}
</code></pre></div><ol start="3">
<li>部署NVIDIA Device Plugin。</li>
</ol>
<p>这里官方推荐的是DaemonSet的形式将Device Plugin部署到K8s集群上，不过基于前面社区的说明，直接使用Docker在本地进行容器化部署、或者将Device Plugin运行为bare-metal-mode都是可以的。</p>
<p>使用K8s DaemonSet部署：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ kubectl create -f https://raw.githubusercontent.com/NVIDIA/k8s-device-plugin/1.0.0-beta4/nvidia-device-plugin.yml
</code></pre></div><p>使用Docker部署：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ docker run --security-opt<span style="color:#f92672">=</span>no-new-privileges --cap-drop<span style="color:#f92672">=</span>ALL --network<span style="color:#f92672">=</span>none -it -v /var/lib/kubelet/device-plugins:/var/lib/kubelet/device-plugins nvidia/k8s-device-plugin:1.0.0-beta4
</code></pre></div><p>裸金属部署：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ C_INCLUDE_PATH<span style="color:#f92672">=</span>/usr/local/cuda/include LIBRARY_PATH<span style="color:#f92672">=</span>/usr/local/cuda/lib64 go build
$ ./k8s-device-plugin
</code></pre></div><ol start="4">
<li>在K8s集群上创建带GPU的workload。</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#66d9ef">apiVersion</span>: v1
<span style="color:#66d9ef">kind</span>: Pod
<span style="color:#66d9ef">metadata</span>:
  <span style="color:#66d9ef">name</span>: gpu-pod
<span style="color:#66d9ef">spec</span>:
  <span style="color:#66d9ef">containers</span>:
    - <span style="color:#66d9ef">name</span>: cuda-container
      <span style="color:#66d9ef">image</span>: nvidia/cuda:<span style="color:#ae81ff">9.0</span>-devel
      <span style="color:#66d9ef">resources</span>:
        <span style="color:#66d9ef">limits</span>:
          <span style="color:#66d9ef">nvidia.com/gpu</span>: <span style="color:#ae81ff">2</span> <span style="color:#75715e"># requesting 2 GPUs</span>
    - <span style="color:#66d9ef">name</span>: digits-container
      <span style="color:#66d9ef">image</span>: nvidia/digits:<span style="color:#ae81ff">6.0</span>
      <span style="color:#66d9ef">resources</span>:
        <span style="color:#66d9ef">limits</span>:
          <span style="color:#66d9ef">nvidia.com/gpu</span>: <span style="color:#ae81ff">2</span> <span style="color:#75715e"># requesting 2 GPUs</span>
</code></pre></div><h3 id="insight">Insight</h3>
<p>以下参考项目主分支的f737ebb9aab0d50b24b1ce513236410fcfd0dee1版本。</p>
<ol>
<li>首先，看一下DaemonSet的YAML以及容器的Dockerfile。</li>
</ol>
<p><code>nvidia-device-plugin.yml</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#66d9ef">apiVersion</span>: apps/v1
<span style="color:#66d9ef">kind</span>: DaemonSet
<span style="color:#66d9ef">metadata</span>:
  <span style="color:#66d9ef">name</span>: nvidia-device-plugin-daemonset
  <span style="color:#66d9ef">namespace</span>: kube-system
<span style="color:#66d9ef">spec</span>:
  <span style="color:#66d9ef">selector</span>:
    <span style="color:#66d9ef">matchLabels</span>:
      <span style="color:#66d9ef">name</span>: nvidia-device-plugin-ds
  <span style="color:#66d9ef">updateStrategy</span>:
    <span style="color:#66d9ef">type</span>: RollingUpdate
  <span style="color:#66d9ef">template</span>:
    <span style="color:#66d9ef">metadata</span>:
      <span style="color:#75715e"># This annotation is deprecated. Kept here for backward compatibility</span>
      <span style="color:#66d9ef">annotations</span>:
        <span style="color:#66d9ef">scheduler.alpha.kubernetes.io/critical-pod</span>: <span style="color:#e6db74">&#34;&#34;</span>
      <span style="color:#66d9ef">labels</span>:
        <span style="color:#66d9ef">name</span>: nvidia-device-plugin-ds
    <span style="color:#66d9ef">spec</span>:
      <span style="color:#66d9ef">tolerations</span>:
      <span style="color:#75715e"># This toleration is deprecated. Kept here for backward compatibility</span>
      - <span style="color:#66d9ef">key</span>: CriticalAddonsOnly
        <span style="color:#66d9ef">operator</span>: Exists
      - <span style="color:#66d9ef">key</span>: nvidia.com/gpu
        <span style="color:#66d9ef">operator</span>: Exists
        <span style="color:#66d9ef">effect</span>: NoSchedule
      <span style="color:#75715e"># Mark this pod as a critical add-on; when enabled, the critical add-on</span>
      <span style="color:#75715e"># scheduler reserves resources for critical add-on pods so that they can</span>
      <span style="color:#75715e"># be rescheduled after a failure.</span>
      <span style="color:#75715e"># See https://kubernetes.io/docs/tasks/administer-cluster/guaranteed-scheduling-critical-addon-pods/</span>
      <span style="color:#66d9ef">priorityClassName</span>: <span style="color:#e6db74">&#34;system-node-critical&#34;</span>
      <span style="color:#66d9ef">containers</span>:
      - <span style="color:#66d9ef">image</span>: nvidia/k8s-device-plugin:<span style="color:#ae81ff">1.0.0</span>-beta4
        <span style="color:#66d9ef">name</span>: nvidia-device-plugin-ctr
        <span style="color:#66d9ef">securityContext</span>:
          <span style="color:#66d9ef">allowPrivilegeEscalation</span>: <span style="color:#66d9ef">false</span>
          <span style="color:#66d9ef">capabilities</span>:
            <span style="color:#66d9ef">drop</span>: [<span style="color:#e6db74">&#34;ALL&#34;</span>]
        <span style="color:#66d9ef">volumeMounts</span>:
          - <span style="color:#66d9ef">name</span>: device-plugin
            <span style="color:#66d9ef">mountPath</span>: /var/lib/kubelet/device-plugins
      <span style="color:#66d9ef">volumes</span>:
        - <span style="color:#66d9ef">name</span>: device-plugin
          <span style="color:#66d9ef">hostPath</span>:
            <span style="color:#66d9ef">path</span>: /var/lib/kubelet/device-plugins
</code></pre></div><p><code>Dockerfile</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-dockerfile" data-lang="dockerfile"><span style="color:#66d9ef">FROM</span><span style="color:#e6db74"> ubuntu:16.04 as build</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">RUN</span> apt-get update <span style="color:#f92672">&amp;&amp;</span> apt-get install -y --no-install-recommends <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>        g++ <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>        ca-certificates <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>        wget <span style="color:#f92672">&amp;&amp;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    rm -rf /var/lib/apt/lists/*<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">ENV</span> GOLANG_VERSION 1.10.3<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">RUN</span> wget -nv -O - https://storage.googleapis.com/golang/go<span style="color:#e6db74">${</span>GOLANG_VERSION<span style="color:#e6db74">}</span>.linux-amd64.tar.gz <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    | tar -C /usr/local -xz<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">ENV</span> GOPATH /go<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">ENV</span> PATH $GOPATH/bin:/usr/local/go/bin:$PATH<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">WORKDIR</span><span style="color:#e6db74"> /go/src/nvidia-device-plugin</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">COPY</span> . .<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">RUN</span> export CGO_LDFLAGS_ALLOW<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;-Wl,--unresolved-symbols=ignore-in-object-files&#39;</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>    go install -ldflags<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;-s -w&#34;</span> -v nvidia-device-plugin<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">FROM</span><span style="color:#e6db74"> debian:stretch-slim</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">ENV</span> NVIDIA_VISIBLE_DEVICES<span style="color:#f92672">=</span>all
<span style="color:#66d9ef">ENV</span> NVIDIA_DRIVER_CAPABILITIES<span style="color:#f92672">=</span>utility

<span style="color:#66d9ef">COPY</span> --from<span style="color:#f92672">=</span>build /go/bin/nvidia-device-plugin /usr/bin/nvidia-device-plugin<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">CMD</span> [<span style="color:#e6db74">&#34;nvidia-device-plugin&#34;</span>]<span style="color:#960050;background-color:#1e0010">
</span></code></pre></div><p>从YAML中可以发现，Device Plugin的workload以DaemonSet形式运行，而<code>/var/lib/kubelet/device-plugins</code>目录会以同样路径挂载，这步挂载显然是为了上节Registration部分中说的Unix Socket通信。</p>
<p>再看Dockerfile，可以看到这里用了multi-stage builds，除了编译运行的依赖以及环境变量需要注意，其他没什么特殊的，在GOPATH和PATH下安装了Go代码的编译产物。这也说明了Device Plugin本身是比较小巧的。</p>
<ol start="2">
<li>看依赖的packages。</li>
</ol>
<p>NVIDIA/k8s-device-plugin这个项目依赖了以下Go packages。</p>
<ul>
<li><code>NVIDIA/gpu-monitoring-tools/bindings/go/nvml</code>: 这是一个cpp+Go的API库，可以监控和管理NVIDIA GPU设备。GPU虚拟化控制面的工作应该主要是由该库负责。</li>
<li><code>notify/fsnotify</code>: 这是一个跨平台的文件系统提醒（filesystem notifications）库，用来watch <code>DevicePluginPath</code>下的变更，以便于Device Plugin感知到Kubelet的重启。</li>
<li><code>kubernetes/pkg/kubelet/apis/deviceplugin/v1beta1</code>: 这是K8s Device Plugin的gRPC API，定义了Device Plugin的gRPC interface和client。</li>
</ul>
<ol start="3">
<li>看源码：<a href="https://github.com/NVIDIA/k8s-device-plugin/blob/f737ebb9aab0d50b24b1ce513236410fcfd0dee1/main.go">NVIDIA/k8s-device-plugin/tree/f737ebb9aab0d50b24b1ce513236410fcfd0dee1</a>。</li>
</ol>
<p>NVIDIA Devive Plugin的主干逻辑分为3块：Device Initialization, Running Loop、Plugin Events。</p>
<p><strong>Device Initialization</strong>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
	<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Loading NVML&#34;</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">nvml</span>.<span style="color:#a6e22e">Init</span>(); <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;Failed to initialize NVML: %s.&#34;</span>, <span style="color:#a6e22e">err</span>)
		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;If this is a GPU node, did you set the docker default runtime to `nvidia`?&#34;</span>)
		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;You can check the prerequisites at: https://github.com/NVIDIA/k8s-device-plugin#prerequisites&#34;</span>)
		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;You can learn how to set the runtime at: https://github.com/NVIDIA/k8s-device-plugin#quick-start&#34;</span>)

		<span style="color:#66d9ef">select</span> {}
	}
	<span style="color:#66d9ef">defer</span> <span style="color:#66d9ef">func</span>() { <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Shutdown of NVML returned:&#34;</span>, <span style="color:#a6e22e">nvml</span>.<span style="color:#a6e22e">Shutdown</span>()) }()

	<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Starting FS watcher.&#34;</span>)
	<span style="color:#a6e22e">watcher</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">newFSWatcher</span>(<span style="color:#a6e22e">pluginapi</span>.<span style="color:#a6e22e">DevicePluginPath</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Failed to created FS watcher.&#34;</span>)
		<span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Exit</span>(<span style="color:#ae81ff">1</span>)
	}
	<span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">watcher</span>.<span style="color:#a6e22e">Close</span>()

	<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Starting OS watcher.&#34;</span>)
	<span style="color:#a6e22e">sigs</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">newOSWatcher</span>(<span style="color:#a6e22e">syscall</span>.<span style="color:#a6e22e">SIGHUP</span>, <span style="color:#a6e22e">syscall</span>.<span style="color:#a6e22e">SIGINT</span>, <span style="color:#a6e22e">syscall</span>.<span style="color:#a6e22e">SIGTERM</span>, <span style="color:#a6e22e">syscall</span>.<span style="color:#a6e22e">SIGQUIT</span>)

	<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Retreiving plugins.&#34;</span>)
	<span style="color:#a6e22e">plugins</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">getAllPlugins</span>()
<span style="color:#f92672">...</span>
</code></pre></div><p>Device Plugin刚运行时会利用<code>NVIDIA/gpu-monitoring-tools</code>的<code>nvml.Init()</code>来初始化NVML，如果加载失败，则Plugin执行失败。<br>
而后，Device Plugin利用<code>notify/fsnotify</code>来watch Kubelet在<code>DevicePluginPath</code>（默认是<code>/var/lib/kubelet/device-plugins</code>）下的变动；同时，利用<code>os/signal</code>来watch进程收到的signals。<br>
最后，Device Plugin会获取代码内记录的所有Plugins，包含了Plugin的资源名和Socket路径，被用于Running Loop阶段中按Plugin挨个重启；不过目前只记录了NVIDIA Device Plugin自己。</p>
<p><strong>Running Loop</strong>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#a6e22e">restart</span>:
	<span style="color:#75715e">// Loop through all plugins, idempotently stopping them, and then starting
</span><span style="color:#75715e"></span>	<span style="color:#75715e">// them if they have any devices to serve. If even one plugin fails to
</span><span style="color:#75715e"></span>	<span style="color:#75715e">// start properly, try starting them all again.
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">started</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>
	<span style="color:#a6e22e">pluginStartError</span> <span style="color:#f92672">:=</span> make(<span style="color:#66d9ef">chan</span> <span style="color:#66d9ef">struct</span>{})
	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">p</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">plugins</span> {
		<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">Stop</span>()

		<span style="color:#75715e">// Just continue if there are no devices to serve for plugin p.
</span><span style="color:#75715e"></span>		<span style="color:#66d9ef">if</span> len(<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">Devices</span>()) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> {
			<span style="color:#66d9ef">continue</span>
		}

		<span style="color:#75715e">// Start the gRPC server for plugin p and connect it with the kubelet.
</span><span style="color:#75715e"></span>		<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">Start</span>(); <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
			<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Could not contact Kubelet, retrying. Did you enable the device plugin feature gate?&#34;</span>)
			<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;You can check the prerequisites at: https://github.com/NVIDIA/k8s-device-plugin#prerequisites&#34;</span>)
			<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;You can learn how to set the runtime at: https://github.com/NVIDIA/k8s-device-plugin#quick-start&#34;</span>)
			close(<span style="color:#a6e22e">pluginStartError</span>)
			<span style="color:#66d9ef">goto</span> <span style="color:#a6e22e">events</span>
		}
		<span style="color:#a6e22e">started</span><span style="color:#f92672">++</span>
	}

	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">started</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> {
		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;No devices found. Waiting indefinitely.&#34;</span>)
	}
<span style="color:#f92672">...</span>
</code></pre></div><p>Running Loop即&quot;restart&quot;代码块内的逻辑。<br>
这里的for循环会遍历前面提到的<code>getAllPlugins()</code>结果，目前代码里只有nvidia-devive-plugin自己。<br>
goto代码块既然名为restart，就意为重启Device Plugin，实际上因为<code>p.Stop()</code>在Plugin刚运行时什么也不做，所以&quot;restart&quot;当作&quot;start&quot;也没问题。<br>
如果是Device Plugin已经运行了一段时间，那么<code>p.Stop()</code>会stop gRPC server、并清理掉socket和部分Plugin的内部变量（包括device lists、server指针、health check和stop的go channel）。</p>
<p>正常情况会进入<code>p.Start()</code>调用，这里会启用Device Plugin的gRPC server（net.Listen()），并向Kubelet注册。注册完毕后，Plugin主进程会起一个go routine来运行GPU的health check（和主进程通过channel通信）。</p>
<p>Health check内会通过<code>nvml</code>库的CGO接口去创建设备的EventSet，底层实现逻辑尚未查明，猜测是为对应GPU设备注册watch事件，以持续监测设备健康状态。</p>
<p>返回到主进程逻辑，<code>p.Start()</code>失败时，会close掉<code>pluginStartError</code>，因为这个channel之前没有写入过，所以执行了<code>&lt;-pluginStartError</code>的语句此时才会解除阻塞，对应了goto到events代码块后的事情。</p>
<p><strong>Plugin Events</strong>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#a6e22e">events</span>:
	<span style="color:#75715e">// Start an infinite loop, waiting for several indicators to either log
</span><span style="color:#75715e"></span>	<span style="color:#75715e">// some messages, trigger a restart of the plugins, or exit the program.
</span><span style="color:#75715e"></span>	<span style="color:#66d9ef">for</span> {
		<span style="color:#66d9ef">select</span> {
		<span style="color:#75715e">// If there was an error starting any plugins, restart them all.
</span><span style="color:#75715e"></span>		<span style="color:#66d9ef">case</span> <span style="color:#f92672">&lt;-</span><span style="color:#a6e22e">pluginStartError</span>:
			<span style="color:#66d9ef">goto</span> <span style="color:#a6e22e">restart</span>

		<span style="color:#75715e">// Detect a kubelet restart by watching for a newly created
</span><span style="color:#75715e"></span>		<span style="color:#75715e">// &#39;pluginapi.KubeletSocket&#39; file. When this occurs, restart this loop,
</span><span style="color:#75715e"></span>		<span style="color:#75715e">// restarting all of the plugins in the process.
</span><span style="color:#75715e"></span>		<span style="color:#66d9ef">case</span> <span style="color:#a6e22e">event</span> <span style="color:#f92672">:=</span> <span style="color:#f92672">&lt;-</span><span style="color:#a6e22e">watcher</span>.<span style="color:#a6e22e">Events</span>:
			<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">event</span>.<span style="color:#a6e22e">Name</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">pluginapi</span>.<span style="color:#a6e22e">KubeletSocket</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">event</span>.<span style="color:#a6e22e">Op</span><span style="color:#f92672">&amp;</span><span style="color:#a6e22e">fsnotify</span>.<span style="color:#a6e22e">Create</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">fsnotify</span>.<span style="color:#a6e22e">Create</span> {
				<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;inotify: %s created, restarting.&#34;</span>, <span style="color:#a6e22e">pluginapi</span>.<span style="color:#a6e22e">KubeletSocket</span>)
				<span style="color:#66d9ef">goto</span> <span style="color:#a6e22e">restart</span>
			}

		<span style="color:#75715e">// Watch for any other fs errors and log them.
</span><span style="color:#75715e"></span>		<span style="color:#66d9ef">case</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#f92672">&lt;-</span><span style="color:#a6e22e">watcher</span>.<span style="color:#a6e22e">Errors</span>:
			<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;inotify: %s&#34;</span>, <span style="color:#a6e22e">err</span>)

		<span style="color:#75715e">// Watch for any signals from the OS. On SIGHUP, restart this loop,
</span><span style="color:#75715e"></span>		<span style="color:#75715e">// restarting all of the plugins in the process. On all other
</span><span style="color:#75715e"></span>		<span style="color:#75715e">// signals, exit the loop and exit the program.
</span><span style="color:#75715e"></span>		<span style="color:#66d9ef">case</span> <span style="color:#a6e22e">s</span> <span style="color:#f92672">:=</span> <span style="color:#f92672">&lt;-</span><span style="color:#a6e22e">sigs</span>:
			<span style="color:#66d9ef">switch</span> <span style="color:#a6e22e">s</span> {
			<span style="color:#66d9ef">case</span> <span style="color:#a6e22e">syscall</span>.<span style="color:#a6e22e">SIGHUP</span>:
				<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Received SIGHUP, restarting.&#34;</span>)
				<span style="color:#66d9ef">goto</span> <span style="color:#a6e22e">restart</span>
			<span style="color:#66d9ef">default</span>:
				<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;Received signal \&#34;%v\&#34;, shutting down.&#34;</span>, <span style="color:#a6e22e">s</span>)
				<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">p</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">plugins</span> {
					<span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">Stop</span>()
				}
				<span style="color:#66d9ef">break</span> <span style="color:#a6e22e">events</span>
			}
		}
	}
}
</code></pre></div><p>&ldquo;events&quot;代码块主要是处理Device Plugin运行中的一些事件：</p>
<ul>
<li><code>p.Start()</code>失败会唤醒<code>case &lt;-pluginStartError</code>，然后重新执行Plugin的Running Loop，即&quot;restart&quot;代码块，以清理并重启gRPC server，重新注册Device Plugin等。</li>
<li>Watch到<code>KubeletSocket</code>重新创建时，会打印Kubelet重启的log，并进入&quot;restart&rdquo;；处理的代码逻辑和上一case基本等同，跳过<code>nvml</code>初始化并重启了Device Plugin。</li>
<li>Watch到其他文件系统的问题会打印日志。</li>
<li>主进程收到signals，如果是SIGHUP就进入&quot;restart&rdquo;、重启server；对其他signals则会停止Device Plugin。</li>
</ul>
<h3 id="discussion">Discussion</h3>
<p>NVIDIA的这个GPU Device Plugin的逻辑很典型地贴合了K8s社区的proposal，笔者虽未进一步调查，不过可以猜测该proposal本身就是和这个Device Plugin一起提出的。</p>
<p>可以看到，Device Plugin本身的代码逻辑比较简单，它需要为设备驱动做好相关的初始化，维护一个被Kubelet call的gRPC server，并处理Kubelet重启等事件；而具体设备驱动、文件系统底层的工作，还是调用其他API，不需要Device Plugin单独实现，这一点也降低了开发的门槛。</p>
<h2 id="intel-sriov-network-device">Intel SRIOV Network Device</h2>
<h2 id="aliyuncontainerservice-gpushare">AliyunContainerService GPUShare</h2>
<h2 id="references">References</h2>
<ol>
<li><a href="https://blog.nowcoder.net/n/2be3d64786a54c40901ba885babff860">Device Plugin 入门笔记（一）</a></li>
<li><a href="https://github.com/kubernetes/community/blob/master/contributors/design-proposals/resource-management/device-plugin.md">Device Manager Proposal - kubernetes/community</a></li>
<li><a href="https://github.com/NVIDIA/k8s-device-plugin">NVIDIA/K8s-device-plugin</a></li>
<li><a href="https://github.com/intel/sriov-network-device-plugin">intel/sriov-network-device-plugin</a></li>
<li><a href="https://github.com/intel/sriov-cni">intel/sriov-cni</a></li>
<li><a href="https://github.com/AliyunContainerService/gpushare-device-plugin">AliyunContainerService/gpushare-device-plugin</a></li>
<li><a href="https://github.com/AliyunContainerService/gpushare-scheduler-extender">AliyunContainerService/gpushare-scheduler-extender</a></li>
</ol>

        </p>
    </div>
    <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "Frame" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    <div class="page-footer">
        
        <hr class="footer-divider">
        
            <a class="tag" href="/tags/cloud">#cloud</a>
        
            <a class="tag" href="/tags/container">#container</a>
        
            <a class="tag" href="/tags/virtualization">#virtualization</a>
        
            <a class="tag" href="/tags/kubernetes">#kubernetes</a>
        
      
    </div>


        

<link rel="stylesheet" type="text/css" href="/css/katex.min.css">
<script type="text/javascript" src="/js/katex.min.js"></script>
<script type="text/javascript" src="/js/auto-render.min.js"onload="renderMathInElement(document.body);"></script>

        </div>
        <footer class="footer-mobile">
	<div class="social-icons">
        
    <a class="social-icon" href="mailto:saintube@foxmail.com" target="_blank" rel="noopener" title="Email">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="https://www.w3.org/2000/svg" xmlns:xlink="https://www.w3.org/1999/xlink">
            <path d="M25.2794292,5.59128519 L14,16.8707144 L2.72057081,5.59128519 C3.06733103,5.30237414 3.51336915,5.12857603 4,5.12857603 L24,5.12857603 C24.4866308,5.12857603 24.932669,5.30237414 25.2794292,5.59128519 Z M25.9956978,6.99633695 C25.998551,7.04004843 26,7.08414302 26,7.12857603 L26,20.871424 C26,21.0798433 25.9681197,21.2808166 25.9089697,21.4697335 L18.7156355,14.2763993 L25.9956978,6.99633695 Z M24.9498374,22.6319215 C24.6672737,22.7846939 24.3437653,22.871424 24,22.871424 L4,22.871424 C3.5268522,22.871424 3.09207889,22.7071233 2.74962118,22.432463 L10.0950247,15.0870594 L13.9848068,18.9768415 L14.1878486,18.7737996 L14.2030419,18.7889929 L17.6549753,15.3370594 L24.9498374,22.6319215 Z M2.00810114,21.0526627 C2.00273908,20.9929669 2,20.9325153 2,20.871424 L2,7.12857603 C2,7.08414302 2.00144896,7.04004843 2.00430222,6.99633695 L9.03436454,14.0263993 L2.00810114,21.0526627 Z"></path>
        </svg>
    </a>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    
    
    <a class="social-icon" href="https://www.github.com/saintube" target="_blank" rel="noopener" title="GitHub">
        <svg width="28px" height="28px" viewBox="0 0 28 28" version="1.1" fill="#ABABAB" xmlns="https://www.w3.org/2000/svg" xmlns:xlink="https://www.w3.org/1999/xlink">
            <path d="M13.9988029,1.32087331 C6.82105037,1.32087331 1,7.14112562 1,14.3212723 C1,20.0649109 4.72454649,24.9370678 9.89038951,26.6560892 C10.5408085,26.7757983 10.7778323,26.374374 10.7778323,26.0296121 C10.7778323,25.7215609 10.7666595,24.9035493 10.760275,23.8189856 C7.14426471,24.6042767 6.38131925,22.0760223 6.38131925,22.0760223 C5.78995672,20.5740732 4.93762853,20.1742451 4.93762853,20.1742451 C3.75729765,19.3682044 5.02701126,19.3841656 5.02701126,19.3841656 C6.33183953,19.4759425 7.01817121,20.7241085 7.01817121,20.7241085 C8.17775254,22.7104801 10.0611744,22.1366749 10.8017741,21.8038838 C10.919887,20.9643246 11.2558703,20.3913175 11.6269683,20.066507 C8.74038491,19.7385043 5.70536235,18.6228163 5.70536235,13.6413251 C5.70536235,12.2223743 6.21213051,11.0611968 7.04370914,10.1530044 C6.90963504,9.82420367 6.46351945,8.50181809 7.17139875,6.71256734 C7.17139875,6.71256734 8.26234691,6.36301702 10.7459099,8.04532771 C11.78259,7.75642995 12.8950858,7.61277914 14.000399,7.60719272 C15.1049142,7.61277914 16.2166119,7.75642995 17.2548881,8.04532771 C19.736855,6.36301702 20.8262071,6.71256734 20.8262071,6.71256734 C21.5356825,8.50181809 21.0895669,9.82420367 20.9562909,10.1530044 C21.7894656,11.0611968 22.2922435,12.2223743 22.2922435,13.6413251 C22.2922435,18.6355852 19.2524325,19.734514 16.3570705,20.0561322 C16.8231376,20.4575564 17.2389269,21.2508282 17.2389269,22.4638795 C17.2389269,24.2012564 17.2229657,25.603448 17.2229657,26.0296121 C17.2229657,26.3775663 17.4575954,26.7821827 18.116793,26.6552912 C23.2786458,24.9322794 27,20.0633148 27,14.3212723 C27,7.14112562 21.1789496,1.32087331 13.9988029,1.32087331"></path>
        </svg>
    </a>
    

    
    
    

    

    

    

    

</div>




	<div class="footer-mobile-links">
		<p><a href="https://www.cncf.io/" target="_blank" rel="noopener">CNCF</a></p>
		<p><a href="https://landscape.cncf.io/" target="_blank" rel="noopener">Landscape</a></p>
		<span class="divider-bar">|</span>
		<p><a href="https://gohugo.io" target="_blank" rel="noopener">Built with Hugo</a></p>
	</div>

	<script src="/js/main.min.fa5c2b23e07b5d9bfad267a52b4b24fdb053e6fb7524993383594926a3ac270c.js" integrity="sha256-+lwrI+B7XZv60melK0sk/bBT5vt1JJkzg1lJJqOsJww="></script>
</footer>
    </body>
</html>